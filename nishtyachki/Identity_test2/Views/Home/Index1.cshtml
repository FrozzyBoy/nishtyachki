@using AdminApp.Nishtiachki;
@using AdminApp.Queue;

<html ng-app="myApp">
<head lang="en">

    <meta charset="utf-8">
    <title>Custom Plunker</title>
    <link rel="stylesheet" type="text/css" href="http://angular-ui.github.com/ng-grid/css/ng-grid.css" />
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.8.0/jquery.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.0.2/angular.min.js"></script>
    <script type="text/javascript" src="http://angular-ui.github.com/ng-grid/lib/ng-grid.debug.js"></script>

    <script type='text/javascript'>
        function NishtCntrl($scope, $http) {
            var url = "http://localhost:60540/api/nisht";

            $http.get(url).success(function (data, status, headers, config) {

                    $scope.nisht = data;
            });
            
            $scope.states = [{ name:'standart' , displayName: 'standart' }, {
                name: 'premium', displayName: 'premium'
            }]

            $scope.delete = function(id){
                var url = "http://localhost:60540/api/nisht/delete";
                $http.post(url + '/' + id);
                
            }
            $scope.changeStat = function (id) {
                var url = "http://localhost:60540/api/nisht/change";
                $http.post(url + '/' + id);
            }
        }
    </script>
    <script>
        function Update($scope, $http) {
            $scope.add = function () {
                var url = "http://localhost:60540/api/nisht/add";
                $http.post(url);
            }
        }
        </script>

    <script>
        var app = angular.module('myApp', ['ngGrid']);
        app.controller('MyCtrl', function ($scope, $http) {

            var url = "http://localhost:60540/api/queue";
            $http.get(url).success(function (data, status, headers, config) {

                $scope.myData = data;
            });
           
            $scope.gridOptions = {
                data: 'myData'
            };
            $scope.roles = [{ name: 'standart',displayName:'standart' },{
                name: 'premium', displayName: 'premium'
            }]
            $scope.delete = function (id) {
                var url = "http://localhost:60540/api/queue/delete";
                $http.post(url + '/' + id);
            }
            $scope.changeStat = function (id, changeRole) {
                var url = "http://localhost:60540/api/queue";
                $http.post(url + '/' + id&changeRole);
            }
        });

    </script>
    <style>
        .gridStyle {
            border: 1px solid rgb(212,212,212);
            width: 400px;
            height: 300px;
        }
    </style>
</head>
<body>
    <div ng-controller="NishtCntrl">
        <p ng-repeat="n in nisht">
            <img src="{{n.Im}}">
            <button ng-click="delete({{n.ID}})">Delete</button>
            <select>
                <option ng-repeat="state in states" value="{{state.name}}" ng-click="changeStat({{n.ID}}, {{}}state.displayName}})">{{state.displayName}}</option>
            </select>
        </p>
    </div>
    <div ng-controller="Update">
        <button ng-click="add()">Add</button>
    </div>

    <div ng-controller="MyCtrl" class="gridStyle" ng-grid="gridOptions">
        <p ng-repeat="d in myData">
            {{d.ID}}
            <button ng-click="delete({{d.ID}})">Delete</button>
           <select><option ng-repeat="role in roles" value="{{role.name}}" ng-click="changeStat({{d.ID}}, {{}}role.displayName}})">{{role.displayName}}</option>
            </select>

        </p>
    </div>

    
    
</body>

</html>